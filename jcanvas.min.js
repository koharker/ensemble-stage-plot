!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).$)}(this,(function(e){"use strict";
/**
	 * @license jCanvas v22.0.1
	 * Copyright 2017-2024 Caleb Evans
	 * Released under the MIT license
	 */var t,r=e.extend,n=e.inArray,a=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},o=e.isPlainObject,i=Math.PI,s=Math.round,l=Math.abs,u=Math.sin,h=Math.cos,d=Math.atan2,c=Array.prototype.slice,f=e.event.fix,g={},v={dataCache:{},propCache:{},imageCache:{}},p={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},y={},m=["mousedown","mousemove","mouseup","mouseover","mouseout","touchstart","touchmove","touchend"];function w(e){var t;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this[t]=e[t]);return this}var x,b={events:{},eventHooks:{},future:{}};function _(){r(this,_.baseDefaults)}function L(e){return"string"===a(e)}function C(e){return"function"===a(e)}function k(e){return!isNaN(Number(e))&&!isNaN(parseFloat(e))}function T(e){return e&&e.getContext?e.getContext("2d"):null}function S(e){var t,r;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r=e[t],"string"===a(r)&&k(r)&&"text"!==t&&(e[t]=parseFloat(r)));void 0!==e.text&&(e.text=String(e.text))}function O(e){return(e=r({},e)).masks=e.masks.slice(0),e}function R(e,t){var r;e.save(),r=O(t.transforms),t.savedTransforms.push(r)}function P(e,t){0===t.savedTransforms.length?t.transforms=O(p):(e.restore(),t.transforms=t.savedTransforms.pop())}function X(e,t,r,n){r[n]&&(C(r[n])?t[n]=r[n].call(e,r):t[n]=r[n])}function Y(e,t,r){X(e,t,r,"fillStyle"),X(e,t,r,"strokeStyle"),t.lineWidth=r.strokeWidth,r.rounded?t.lineCap=t.lineJoin="round":(t.lineCap=r.strokeCap,t.lineJoin=r.strokeJoin,t.miterLimit=r.miterLimit),r.strokeDash||(r.strokeDash=[]),t.setLineDash&&t.setLineDash(r.strokeDash),t.webkitLineDash=r.strokeDash,t.lineDashOffset=t.webkitLineDashOffset=t.mozDashOffset=r.strokeDashOffset,t.shadowOffsetX=r.shadowX,t.shadowOffsetY=r.shadowY,t.shadowBlur=r.shadowBlur,t.shadowColor=r.shadowColor,t.globalAlpha=r.opacity,t.globalCompositeOperation=r.compositing,r.imageSmoothing&&(t.imageSmoothingEnabled=r.imageSmoothing)}function D(e,t,r){r.mask&&(r.autosave&&R(e,t),e.clip(),t.transforms.masks.push(r._args))}function j(e,t){t._transformed&&e.restore()}function A(e,t,r){r.closed&&t.closePath(),r.shadowStroke&&0!==r.strokeWidth?(t.stroke(),t.fill(),t.shadowColor="transparent",t.shadowBlur=0,t.stroke()):(t.fill(),"transparent"!==r.fillStyle&&(t.shadowColor="transparent"),0!==r.strokeWidth&&t.stroke()),r.closed||t.closePath(),j(t,r),r.mask&&D(t,z(e),r)}function W(e,t,r,n,a){r._toRad=r.inDegrees?i/180:1,r._transformed=!0,t.save(),r.fromCenter||r._centered||void 0===n||(void 0===a&&(a=n),r.x+=n/2,r.y+=a/2,r._centered=!0),r.rotate&&ae(t,r,null),1===r.scale&&1===r.scaleX&&1===r.scaleY||oe(t,r,null),(r.translate||r.translateX||r.translateY)&&ie(t,r,null)}function z(t){var r,n=v.dataCache;return n._canvas===t&&n._data?r=n._data:((r=e.data(t,"jCanvas"))||(r={canvas:t,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:null,cursor:e(t).css("cursor"),drag:{layer:null,dragging:!1},event:{type:null,x:null,y:null},events:{},transforms:O(p),savedTransforms:[],animating:!1,animated:null,pixelRatio:1,scaled:!1,redrawOnMousemove:!1},e.data(t,"jCanvas",r)),n._canvas=t,n._data=r),r}function H(e,t,r){var n;for(n in b.events)Object.prototype.hasOwnProperty.call(b.events,n)&&(r[n]||r.cursors&&r.cursors[n])&&E(e,t,r,n);t.events.mouseout||(e.bind("mouseout.jCanvas",(function(){var r,n=t.drag.layer;for(n&&(t.drag={},Q(e,t,n,"dragcancel")),r=0;r<t.layers.length;r+=1)(n=t.layers[r])._hovered&&e.triggerLayerEvent(t.layers[r],"mouseout");e.drawLayers()})),t.events.mouseout=!0)}function F(e,t,r,n){b.events[n](e,t),r._event=!0}function E(e,t,r,n){F(e,t,r,n),"mouseover"!==n&&"mouseout"!==n&&"mousemove"!==n||(t.redrawOnMousemove=!0)}function G(e,t,r){var n,a;if(r.draggable||r.cursors){for(n=["mousedown","mousemove","mouseup"],a=0;a<n.length;a+=1)F(e,t,r,n[a]);r._event=!0}}function I(e,t,r,n){var a=t.layer.names;n?void 0!==n.name&&L(r.name)&&r.name!==n.name&&delete a[r.name]:n=r,L(n.name)&&(a[n.name]=r)}function M(e,t,r,n){var a,o,i,s,l,u=t.layer.groups;if(n){if(void 0!==n.groups&&null!==r.groups)for(i=0;i<r.groups.length;i+=1)if(a=u[o=r.groups[i]]){for(l=0;l<a.length;l+=1)if(a[l]===r){s=l,a.splice(l,1);break}0===a.length&&delete u[o]}}else n=r;if(void 0!==n.groups&&null!==n.groups)for(i=0;i<n.groups.length;i+=1)(a=u[o=n.groups[i]])||((a=u[o]=[]).name=o),void 0===s&&(s=a.length),a.splice(s,0,r)}function B(e){var t,r,n;for(t=null,r=e.intersecting.length-1;r>=0;r-=1)if((t=e.intersecting[r])._masks){for(n=t._masks.length-1;n>=0;n-=1)if(!t._masks[n].intersects){t.intersects=!1;break}if(t.intersects&&!t.intangible)break}return t&&t.intangible&&(t=null),t}function N(e,t,r,n){r&&r.visible&&r._method&&(r._next=n||null,r._method&&r._method.call(e,r))}function q(e,t,r){var n,a,o,i,s,l,u,h,d,c;if(s=(a=(i=t.drag).layer)&&a.dragGroups||[],n=t.layers,"mousemove"===r||"touchmove"===r){if(i.dragging||(i.dragging=!0,a.dragging=!0,a.bringToFront&&(n.splice(a.index,1),a.index=n.push(a)),a._startX=a.x,a._startY=a.y,a._endX=a._eventX,a._endY=a._eventY,Q(e,t,a,"dragstart")),i.dragging)for(d=a._eventX-(a._endX-a._startX),c=a._eventY-(a._endY-a._startY),a.updateDragX&&(d=a.updateDragX.call(e[0],a,d)),a.updateDragY&&(c=a.updateDragY.call(e[0],a,c)),a.dx=d-a.x,a.dy=c-a.y,"y"!==a.restrictDragToAxis&&(a.x=d),"x"!==a.restrictDragToAxis&&(a.y=c),Q(e,t,a,"drag"),h=0;h<s.length;h+=1)if(u=s[h],l=t.layer.groups[u],a.groups&&l)for(o=0;o<l.length;o+=1)l[o]!==a&&("y"!==a.restrictDragToAxis&&"y"!==l[o].restrictDragToAxis&&(l[o].x+=a.dx),"x"!==a.restrictDragToAxis&&"x"!==l[o].restrictDragToAxis&&(l[o].y+=a.dy))}else"mouseup"!==r&&"touchend"!==r||(i.dragging&&(a.dragging=!1,i.dragging=!1,t.redrawOnMousemove=t.originalRedrawOnMousemove,Q(e,t,a,"dragstop")),t.drag={})}function J(e,t){e.css({cursor:t.cursor})}function $(e,t,r,n,a){n[r]&&t._running&&!t._running[r]&&(t._running[r]=!0,n[r].call(e[0],t,a),t._running[r]=!1)}function Q(t,r,n,a,o){(function(t,r){return!(t.disableEvents||t.intangible&&-1!==e.inArray(r,m))})(n,a)&&("mouseout"!==a&&function(t,r,n){var a;r.cursors&&(a=r.cursors[n]),-1!==e.inArray(a,y.cursors)&&(a=y.prefix+a),a&&t.css({cursor:a})}(t,n,a),$(t,n,a,n,o),$(t,n,a,r.eventHooks,o),$(t,n,a,b.eventHooks,o))}function U(t,n,a,o){var i,s,l,u=n._layer?a:n;return n._args=a,(n.draggable||n.dragGroups)&&(n.layer=!0,n.draggable=!0),n._method||(o?n._method=o:n.method?n._method=e.fn[n.method]:n.type&&(n._method=e.fn[g.drawings[n.type]])),n.layer&&!n._layer?(i=e(t),l=(s=z(t)).layers,(null===u.name||L(u.name)&&void 0===s.layer.names[u.name])&&(S(n),(u=new w(n)).canvas=t,u.layer=!0,u._layer=!0,u._running={},null!==u.data?u.data=r({},u.data):u.data={},null!==u.groups?u.groups=u.groups.slice(0):u.groups=[],I(0,s,u),M(0,s,u),H(i,s,u),G(i,s,u),n._event=u._event,u._method===e.fn.drawText&&i.measureText(u),null===u.index&&(u.index=l.length),l.splice(u.index,0,u),n._args=u,Q(i,s,u,"add"))):n.layer||S(n),u}function V(e,t){var r,n;for(n=0;n<y.props.length;n+=1)void 0!==e[r=y.props[n]]&&(e["_"+r]=e[r],y.propsObj[r]=!0,t&&delete e[r])}function K(e,t,r){var n,i,s,l;for(n in r)if(Object.prototype.hasOwnProperty.call(r,n)&&(C(i=r[n])&&(r[n]=i.call(e,t,n)),"object"===a(i)&&o(i))){for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(l=i[s],void 0!==t[n]&&(t[n+"."+s]=t[n][s],r[n+"."+s]=l));delete r[n]}return r}function Z(t){var r,n,a=[],o=1;return"transparent"===t?t="rgba(0, 0, 0, 0)":t.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&(r=(n=document.head).style.color,n.style.color=t,t=e.css(n,"color"),n.style.color=r),t.match(/^rgb/gi)&&(a=t.match(/(\d+(\.\d+)?)/gi),t.match(/%/gi)&&(o=2.55),a[0]*=o,a[1]*=o,a[2]*=o,void 0!==a[3]?a[3]=parseFloat(a[3]):a[3]=1),a}function ee(e){var t,r=3;for("array"!==a(e.start)&&(e.start=Z(e.start),e.end=Z(e.end)),e.now=[],1===e.start[3]&&1===e.end[3]||(r=4),t=0;t<r;t+=1)e.now[t]=e.start[t]+(e.end[t]-e.start[t])*e.pos,t<3&&(e.now[t]=s(e.now[t]));1!==e.start[3]||1!==e.end[3]?e.now="rgba("+e.now.join(",")+")":(e.now.slice(0,3),e.now="rgb("+e.now.join(",")+")"),e.elem.nodeName?e.elem.style[e.prop]=e.now:e.elem[e.prop]=e.now}function te(e){return g.mouseEvents[e]&&(e=g.mouseEvents[e]),e}function re(e){b.events[e]=function(t,r){var n,a,o;function i(e){o.x=e.offsetX,o.y=e.offsetY,o.type=n,o.event=e,("mousemove"!==e.type||r.redrawOnMousemove||r.drag.dragging)&&t.drawLayers({resetFire:!0}),e.preventDefault()}o=r.event,a=function(e){return g.touchEvents[e]&&(e=g.touchEvents[e]),e}(n="mouseover"===e||"mouseout"===e?"mousemove":e),r.events[n]||(a!==n?t.bind(n+".jCanvas "+a+".jCanvas",i):t.bind(n+".jCanvas",i),r.events[n]=!0)}}function ne(e,t,r){var n,a,o,i,s,l,d,c;(n=r._args)&&(null!==(o=(a=z(e)).event).x&&null!==o.y&&(l=o.x*a.pixelRatio,d=o.y*a.pixelRatio,i=t.isPointInPath(l,d)||t.isPointInStroke&&t.isPointInStroke(l,d)),s=a.transforms,n.eventX=o.x,n.eventY=o.y,n.event=o.event,c=a.transforms.rotate,l=n.eventX,d=n.eventY,0!==c?(n._eventX=l*h(-c)-d*u(-c),n._eventY=d*h(-c)+l*u(-c)):(n._eventX=l,n._eventY=d),n._eventX/=s.scaleX,n._eventY/=s.scaleY,i&&a.intersecting.push(n),n.intersects=Boolean(i))}function ae(e,t,r){t._toRad=t.inDegrees?i/180:1,e.translate(t.x,t.y),e.rotate(t.rotate*t._toRad),e.translate(-t.x,-t.y),r&&(r.rotate+=t.rotate*t._toRad)}function oe(e,t,r){1!==t.scale&&(t.scaleX=t.scaleY=t.scale),e.translate(t.x,t.y),e.scale(t.scaleX,t.scaleY),e.translate(-t.x,-t.y),r&&(r.scaleX*=t.scaleX,r.scaleY*=t.scaleY)}function ie(e,t,r){t.translate&&(t.translateX=t.translateY=t.translate),e.translate(t.translateX,t.translateY),r&&(r.translateX+=t.translateX,r.translateY+=t.translateY)}function se(e){for(;e<0;)e+=2*i;return e}function le(e,t){return e.x+e.radius*h(t)}function ue(e,t){return e.y+e.radius*u(t)}function he(e,t,r,n){var a,o,s,l,u;r===n?(s=0,l=0):(s=r.x,l=r.y),n.inDegrees||360!==n.end||(n.end=2*i),n.start*=r._toRad,n.end*=r._toRad,n.start-=i/2,n.end-=i/2,u=i/180,n.ccw&&(u*=-1),ce(e,t,r,n,le(n,n.start+u),ue(n,n.start+u),le(n,n.start),ue(n,n.start)),t.arc(n.x+s,n.y+l,n.radius,n.start,n.end,n.ccw),a=le(n,n.end+u),o=ue(n,n.end+u),fe(e,t,r,n,le(n,n.end),ue(n,n.end),a,o)}function de(e,t,r,n,a,o,s,l){var c,f,g,v,p,y,m;n.arrowRadius&&!r.closed&&(m=d(l-o,s-a),m-=i,p=r.strokeWidth*h(m),y=r.strokeWidth*u(m),c=s+n.arrowRadius*h(m+n.arrowAngle/2),f=l+n.arrowRadius*u(m+n.arrowAngle/2),g=s+n.arrowRadius*h(m-n.arrowAngle/2),v=l+n.arrowRadius*u(m-n.arrowAngle/2),t.moveTo(c-p,f-y),t.lineTo(s-p,l-y),t.lineTo(g-p,v-y),t.moveTo(s-p,l-y),t.lineTo(s+p,l+y),t.moveTo(s,l))}function ce(e,t,r,n,a,o,i,s){n._arrowAngleConverted||(n.arrowAngle*=r._toRad,n._arrowAngleConverted=!0),n.startArrow&&de(0,t,r,n,a,o,i,s)}function fe(e,t,r,n,a,o,i,s){n._arrowAngleConverted||(n.arrowAngle*=r._toRad,n._arrowAngleConverted=!0),n.endArrow&&de(0,t,r,n,a,o,i,s)}function ge(e,t,r,n){var a,o,i;for(a=2,ce(0,t,r,n,n.x2+r.x,n.y2+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&t.moveTo(n.x1+r.x,n.y1+r.y);o=n["x"+a],i=n["y"+a],void 0!==o&&void 0!==i;)t.lineTo(o+r.x,i+r.y),a+=1;fe(0,t,r,n,n["x"+((a-=1)-1)]+r.x,n["y"+(a-1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function ve(e,t,r,n){var a,o,i,s,l;for(a=2,ce(0,t,r,n,n.cx1+r.x,n.cy1+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&t.moveTo(n.x1+r.x,n.y1+r.y);o=n["x"+a],i=n["y"+a],s=n["cx"+(a-1)],l=n["cy"+(a-1)],void 0!==o&&void 0!==i&&void 0!==s&&void 0!==l;)t.quadraticCurveTo(s+r.x,l+r.y,o+r.x,i+r.y),a+=1;fe(0,t,r,n,n["cx"+((a-=1)-1)]+r.x,n["cy"+(a-1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function pe(e,t,r,n){var a,o,i,s,l,u,h,d;for(a=2,o=1,ce(0,t,r,n,n.cx1+r.x,n.cy1+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&t.moveTo(n.x1+r.x,n.y1+r.y);i=n["x"+a],s=n["y"+a],l=n["cx"+o],u=n["cy"+o],h=n["cx"+(o+1)],d=n["cy"+(o+1)],void 0!==i&&void 0!==s&&void 0!==l&&void 0!==u&&void 0!==h&&void 0!==d;)t.bezierCurveTo(l+r.x,u+r.y,h+r.x,d+r.y,i+r.x,s+r.y),a+=1,o+=2;a-=1,fe(0,t,r,n,n["cx"+((o-=2)+1)]+r.x,n["cy"+(o+1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function ye(e,t,r){return t*=e._toRad,r*h(t-=i/2)}function me(e,t,r){return t*=e._toRad,r*u(t-=i/2)}function we(e,t,r,n){var a,o,i,s,l,u,h,d,c,f,g;for(r===n?(s=0,l=0):(s=r.x,l=r.y),a=1,u=d=f=n.x+s,h=c=g=n.y+l,ce(0,t,r,n,u+ye(r,n.a1,n.l1),h+me(r,n.a1,n.l1),u,h),void 0!==n.x&&void 0!==n.y&&t.moveTo(u,h);o=n["a"+a],i=n["l"+a],void 0!==o&&void 0!==i;)d=f,c=g,f+=ye(r,o,i),g+=me(r,o,i),t.lineTo(f,g),a+=1;fe(0,t,r,n,d,c,f,g)}function xe(e,t,r){isNaN(Number(r.fontSize))||(r.fontSize+="px"),t.font=r.fontStyle+" "+r.fontSize+" "+r.fontFamily}function be(t,r,n,a){var o,i,s,l=v.propCache;if(l.text===n.text&&l.fontStyle===n.fontStyle&&l.fontSize===n.fontSize&&l.fontFamily===n.fontFamily&&l.maxWidth===n.maxWidth&&l.lineHeight===n.lineHeight)n.width=l.width,n.height=l.height;else{for(n.width=r.measureText(a[0]).width,s=1;s<a.length;s+=1)(i=r.measureText(a[s]).width)>n.width&&(n.width=i);o=t.style.fontSize,t.style.fontSize=n.fontSize,n.height=parseFloat(e.css(t,"fontSize"))*a.length*n.lineHeight,t.style.fontSize=o}}function _e(e,t){var r,n,a,o,i,s,l=String(t.text),u=t.maxWidth,h=l.split("\n"),d=[];for(a=0;a<h.length;a+=1){if(r=[],n="",1===(i=(o=h[a]).split(" ")).length||e.measureText(o).width<u)r=[o];else{for(s=0;s<i.length;s+=1)e.measureText(n+i[s]).width>u&&(""!==n&&r.push(n),n=""),n+=i[s],s!==i.length-1&&(n+=" ");r.push(n)}d=d.concat(r.join("\n").replace(/((\n))|($)/gi,"$2").split("\n"))}return d}_.baseDefaults={align:"center",arrowAngle:90,arrowRadius:0,autosave:!0,baseline:"middle",bringToFront:!1,ccw:!1,closed:!1,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:!0,crossOrigin:null,cursors:null,disableEvents:!1,draggable:!1,dragGroups:null,groups:null,data:null,dx:null,dy:null,end:360,eventX:null,eventY:null,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:!0,height:null,imageSmoothing:!0,inDegrees:!0,intangible:!1,index:null,letterSpacing:null,lineHeight:1,layer:!1,mask:!1,maxWidth:null,miterLimit:10,name:null,opacity:1,r1:null,r2:null,radius:0,repeat:"repeat",respectAlign:!1,restrictDragToAxis:null,rotate:0,rounded:!1,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:!1,shadowX:0,shadowY:0,sHeight:null,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeDash:null,strokeDashOffset:0,strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:null,sx:null,sy:null,text:"",translate:0,translateX:0,translateY:0,type:null,visible:!0,width:null,x:0,y:0},t=new _,w.prototype=t,b.extend=function(n){return n.name&&(n.props&&r(t,n.props),e.fn[n.name]=function e(t){var r,a,o,i,s=this;for(a=0;a<s.length;a+=1)(o=T(r=s[a]))&&(U(r,i=new w(t),t,e),Y(r,o,i),n.fn.call(r,o,i));return s},n.type&&(g.drawings[n.type]=n.name)),e.fn[n.name]},e.fn.getEventHooks=function(){var e={};return 0!==this.length&&(e=z(this[0]).eventHooks),e},e.fn.setEventHooks=function(e){var t,n,a=this;for(t=0;t<a.length;t+=1)n=z(a[t]),r(n.eventHooks,e);return a},e.fn.getLayers=function(e){var t,r,n,a,o=[];if(0!==this.length)if(r=z(t=this[0]).layers,C(e))for(a=0;a<r.length;a+=1)n=r[a],e.call(t,n)&&o.push(n);else o=r;return o},e.fn.getLayer=function(e){var t,r,n,o,i;if(0!==this.length)if(r=(t=z(this[0])).layers,i=a(e),e&&e.layer)n=e;else if("number"===i)e<0&&(e=r.length+e),n=r[e];else if("regexp"===i){for(o=0;o<r.length;o+=1)if(L(r[o].name)&&r[o].name.match(e)){n=r[o];break}}else n=t.layer.names[e];return n},e.fn.getLayerGroup=function(e){var t,r,n,o,i=a(e);if(0!==this.length)if(t=this[0],"array"===i)o=e;else if("regexp"===i){for(n in r=z(t).layer.groups)if(n.match(e)){o=r[n];break}}else o=z(t).layer.groups[e];return o},e.fn.getLayerIndex=function(e){var t=this.getLayers(),r=this.getLayer(e);return n(r,t)},e.fn.setLayer=function(t,n){var i,s,l,u,h,d,c,f=this;for(s=0;s<f.length;s+=1)if(i=e(f[s]),l=z(f[s]),u=e(f[s]).getLayer(t)){for(h in I(0,l,u,n),M(0,l,u,n),S(n),n)Object.prototype.hasOwnProperty.call(n,h)&&(d=n[h],"object"===(c=a(d))&&o(d)?(u[h]=r({},d),S(u[h])):"array"===c?u[h]=d.slice(0):"string"===c?0===d.indexOf("+=")?u[h]+=parseFloat(d.substr(2)):0===d.indexOf("-=")?u[h]-=parseFloat(d.substr(2)):!isNaN(d)&&k(d)&&"text"!==h?u[h]=parseFloat(d):u[h]=d:u[h]=d);H(i,l,u),G(i,l,u),!1===e.isEmptyObject(n)&&Q(i,l,u,"change",n)}return f},e.fn.setLayers=function(t,r){var n,a,o,i,s=this;for(a=0;a<s.length;a+=1)for(o=(n=e(s[a])).getLayers(r),i=0;i<o.length;i+=1)n.setLayer(o[i],t);return s},e.fn.setLayerGroup=function(t,r){var n,a,o,i,s=this;for(a=0;a<s.length;a+=1)if(o=(n=e(s[a])).getLayerGroup(t))for(i=0;i<o.length;i+=1)n.setLayer(o[i],r);return s},e.fn.moveLayer=function(t,r){var a,o,i,s,l,u=this;for(o=0;o<u.length;o+=1)a=e(u[o]),s=(i=z(u[o])).layers,(l=a.getLayer(t))&&(l.index=n(l,s),s.splice(l.index,1),s.splice(r,0,l),r<0&&(r=s.length+r),l.index=r,Q(a,i,l,"move"));return u},e.fn.removeLayer=function(t){var r,a,o,i,s,l=this;for(a=0;a<l.length;a+=1)r=e(l[a]),o=z(l[a]),i=r.getLayers(),(s=r.getLayer(t))&&(s.index=n(s,i),i.splice(s.index,1),delete s._layer,I(0,o,s,{name:null}),M(0,o,s,{groups:null}),Q(r,o,s,"remove"));return l},e.fn.removeLayers=function(t){var r,n,a,o,i,s,l=this;for(n=0;n<l.length;n+=1){for(r=e(l[n]),a=z(l[n]),o=r.getLayers(t).slice(0),s=0;s<o.length;s+=1)i=o[s],r.removeLayer(i);a.layer.names={},a.layer.groups={}}return l},e.fn.removeLayerGroup=function(t){var r,n,a,o,i=this;if(void 0!==t)for(n=0;n<i.length;n+=1)if(a=(r=e(i[n])).getLayerGroup(t))for(a=a.slice(0),o=0;o<a.length;o+=1)r.removeLayer(a[o]);return i},e.fn.addLayerToGroup=function(t,r){var a,o,i,s=this,l=[r];for(o=0;o<s.length;o+=1)(i=(a=e(s[o])).getLayer(t)).groups&&(l=i.groups.slice(0),-1===n(r,i.groups)&&l.push(r)),a.setLayer(i,{groups:l});return s},e.fn.removeLayerFromGroup=function(t,r){var a,o,i,s,l=this,u=[];for(o=0;o<l.length;o+=1)(i=(a=e(l[o])).getLayer(t)).groups&&-1!==(s=n(r,i.groups))&&((u=i.groups.slice(0)).splice(s,1),a.setLayer(i,{groups:u}));return l},y.cursors=["grab","grabbing","zoom-in","zoom-out"],y.prefix=(x=getComputedStyle(document.documentElement,""),"-"+(c.call(x).join("").match(/-(moz|webkit|ms)-/)||""===x.OLink&&["","o"])[1]+"-"),e.fn.triggerLayerEvent=function(t,r){var n,a,o,i=this;for(a=0;a<i.length;a+=1)n=e(i[a]),o=z(i[a]),(t=n.getLayer(t))&&Q(n,o,t,r);return i},e.fn.drawLayer=function(t){var r,n,a,o=this;for(r=0;r<o.length;r+=1)n=e(o[r]),T(o[r])&&(a=n.getLayer(t),N(n,0,a));return o},e.fn.drawLayers=function(t){var r,n,a,o,i,s,l,u,h,d,c,f,g=this,v=t||{};for((l=v.index)||(l=0),n=0;n<g.length;n+=1)if(r=e(g[n]),T(g[n])){for(h=z(g[n]),!1!==v.clear&&r.clearCanvas(),v.complete&&(h.drawLayersComplete=v.complete),a=h.layers,s=l;s<a.length;s+=1)if((o=a[s]).index=s,v.resetFire&&(o._fired=!1),N(r,0,o,s+1),o._masks=h.transforms.masks.slice(0),o._method===e.fn.drawImage&&o.visible){f=!0;break}if(f)continue;u=s,v.complete&&(v.complete.call(g[n]),delete h.drawLayersComplete),o=B(h),c=(d=h.event).type,h.drag.layer&&q(r,h,c),null===(i=h.lastIntersected)||o===i||!i._hovered||i._fired||h.drag.dragging||(h.lastIntersected=null,i._fired=!0,i._hovered=!1,Q(r,h,i,"mouseout"),J(r,h)),o&&(o[c]||(c=te(c)),o._event&&o.intersects&&(h.lastIntersected=o,(o.mouseover||o.mouseout||o.cursors)&&!h.drag.dragging&&(o._hovered||o._fired||(o._fired=!0,o._hovered=!0,Q(r,h,o,"mouseover"))),o._fired||(o._fired=!0,d.type=null,Q(r,h,o,c)),!o.draggable||o.disableEvents||"mousedown"!==c&&"touchstart"!==c||(h.drag.layer=o,h.originalRedrawOnMousemove=h.redrawOnMousemove,h.redrawOnMousemove=!0))),null!==o||h.drag.dragging||J(r,h),u===a.length&&(h.intersecting.length=0,h.transforms=O(p),h.savedTransforms.length=0)}return g},e.fn.addLayer=function(e){var t,r,n=this;for(t=0;t<n.length;t+=1)T(n[t])&&((r=new w(e)).layer=!0,U(n[t],r,e));return n},y.props=["width","height","opacity","lineHeight"],y.propsObj={},e.fn.animateLayer=function(){var t,n,o,i,s,l=this,u=c.call(arguments,0);function h(e,t,r){return function(){!function(e){var t,r;for(r=0;r<y.props.length;r+=1)e[t=y.props[r]]=e["_"+t]}(r),function(e){var t;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&-1!==t.indexOf(".")&&delete e[t]}(r),t.animating&&t.animated!==r||e.drawLayers(),r._animating=!1,t.animating=!1,t.animated=null,u[4]&&u[4].call(e[0],r),Q(e,t,r,"animateend")}}function d(e,t,r){return function(n,a){var o,i,s,l=!1;"_"===a.prop[0]&&(l=!0,a.prop=a.prop.replace("_",""),r[a.prop]=r["_"+a.prop]),-1!==a.prop.indexOf(".")&&(i=(o=a.prop.split("."))[0],s=o[1],r[i]&&(r[i][s]=a.now)),r._pos!==a.pos&&(r._pos=a.pos,r._animating||t.animating||(r._animating=!0,t.animating=!0,t.animated=r),t.animating&&t.animated!==r||e.drawLayers()),u[5]&&u[5].call(e[0],n,a,r),Q(e,t,r,"animate",a),l&&(a.prop="_"+a.prop)}}for("object"===a(u[2])?(u.splice(2,0,u[2].duration||null),u.splice(3,0,u[3].easing||null),u.splice(4,0,u[4].complete||null),u.splice(5,0,u[5].step||null)):(void 0===u[2]?(u.splice(2,0,null),u.splice(3,0,null),u.splice(4,0,null)):C(u[2])&&(u.splice(2,0,null),u.splice(3,0,null)),void 0===u[3]?(u[3]=null,u.splice(4,0,null)):C(u[3])&&u.splice(3,0,null)),n=0;n<l.length;n+=1)t=e(l[n]),T(l[n])&&(o=z(l[n]),(i=t.getLayer(u[0]))&&i._method!==e.fn.draw&&(s=r({},u[1]),V(s=K(l[n],i,s),!0),V(i),i.style=y.propsObj,e(i).animate(s,{duration:u[2],easing:e.easing[u[3]]?u[3]:null,complete:h(t,o,i),step:d(t,o,i)}),Q(t,o,i,"animatestart")));return l},e.fn.animateLayerGroup=function(t){var r,n,a,o,i=this,s=c.call(arguments,0);for(n=0;n<i.length;n+=1)if(a=(r=e(i[n])).getLayerGroup(t))for(o=0;o<a.length;o+=1)s[0]=a[o],r.animateLayer.apply(r,s);return i},e.fn.delayLayer=function(t,r){var n,a,o,i,s=this;for(r=r||0,a=0;a<s.length;a+=1)n=e(s[a]),o=z(s[a]),(i=n.getLayer(t))&&(e(i).delay(r),Q(n,o,i,"delay"));return s},e.fn.delayLayerGroup=function(t,r){var n,a,o,i,s,l=this;for(r=r||0,a=0;a<l.length;a+=1)if(o=(n=e(l[a])).getLayerGroup(t))for(s=0;s<o.length;s+=1)i=o[s],n.delayLayer(i,r);return l},e.fn.stopLayer=function(t,r){var n,a,o,i,s=this;for(a=0;a<s.length;a+=1)n=e(s[a]),o=z(s[a]),(i=n.getLayer(t))&&(e(i).stop(r),Q(n,o,i,"stop"));return s},e.fn.stopLayerGroup=function(t,r){var n,a,o,i,s,l=this;for(a=0;a<l.length;a+=1)if(o=(n=e(l[a])).getLayerGroup(t))for(s=0;s<o.length;s+=1)i=o[s],n.stopLayer(i,r);return l},function(t){var r;for(r=0;r<t.length;r+=1)e.fx.step[t[r]]=ee}(["color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","fillStyle","outlineColor","strokeStyle","shadowColor"]),g.touchEvents={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},g.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"},function(e){var t;for(t=0;t<e.length;t+=1)re(e[t])}(["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","touchstart","touchmove","touchend","pointerdown","pointermove","pointerup","contextmenu"]),e.event.fix=function(t){var r,n,a;if(n=(t=f.call(e.event,t)).originalEvent)if(a=n.changedTouches,void 0!==t.pageX&&void 0===t.offsetX)try{(r=e(t.currentTarget).offset())&&(t.offsetX=t.pageX-r.left,t.offsetY=t.pageY-r.top)}catch(e){}else if(a)try{(r=e(t.currentTarget).offset())&&(t.offsetX=a[0].pageX-r.left,t.offsetY=a[0].pageY-r.top)}catch(e){}return t},g.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse",function:"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector",save:"saveCanvas",restore:"restoreCanvas",rotate:"rotateCanvas",scale:"scaleCanvas",translate:"translateCanvas"},e.fn.draw=function e(t){var r,n,a=this,o=new w(t);if(g.drawings[o.type]&&"function"!==o.type)a[g.drawings[o.type]](t);else for(r=0;r<a.length;r+=1)(n=T(a[r]))&&(o=new w(t),U(a[r],o,t,e),o.visible&&o.fn&&o.fn.call(a[r],n,o));return a},e.fn.clearCanvas=function e(t){var r,n,a=this,o=new w(t);for(r=0;r<a.length;r+=1)(n=T(a[r]))&&(null===o.width||null===o.height?(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,a[r].width,a[r].height),n.restore()):(U(a[r],o,t,e),W(a[r],n,o,o.width,o.height),n.clearRect(o.x-o.width/2,o.y-o.height/2,o.width,o.height),j(n,o)));return a},e.fn.saveCanvas=function e(t){var r,n,a,o,i,s=this;for(r=0;r<s.length;r+=1)if(n=T(s[r]))for(o=z(s[r]),a=new w(t),U(s[r],a,t,e),i=0;i<a.count;i+=1)R(n,o);return s},e.fn.restoreCanvas=function e(t){var r,n,a,o,i,s=this;for(r=0;r<s.length;r+=1)if(n=T(s[r]))for(o=z(s[r]),a=new w(t),U(s[r],a,t,e),i=0;i<a.count;i+=1)P(n,o);return s},e.fn.rotateCanvas=function e(t){var r,n,a,o,i=this;for(r=0;r<i.length;r+=1)(n=T(i[r]))&&(o=z(i[r]),a=new w(t),U(i[r],a,t,e),a.autosave&&R(n,o),ae(n,a,o.transforms));return i},e.fn.scaleCanvas=function e(t){var r,n,a,o,i=this;for(r=0;r<i.length;r+=1)(n=T(i[r]))&&(o=z(i[r]),a=new w(t),U(i[r],a,t,e),a.autosave&&R(n,o),oe(n,a,o.transforms));return i},e.fn.translateCanvas=function e(t){var r,n,a,o,i=this;for(r=0;r<i.length;r+=1)(n=T(i[r]))&&(o=z(i[r]),a=new w(t),U(i[r],a,t,e),a.autosave&&R(n,o),ie(n,a,o.transforms));return i},e.fn.drawRect=function e(t){var r,n,a,o,s,u,h,d,c,f=this;for(r=0;r<f.length;r+=1)(n=T(f[r]))&&(a=new w(t),U(f[r],a,t,e),a.visible&&(W(f[r],n,a,a.width,a.height),Y(f[r],n,a),n.beginPath(),a.width&&a.height&&(o=a.x-a.width/2,s=a.y-a.height/2,(d=l(a.cornerRadius))?(u=a.x+a.width/2,h=a.y+a.height/2,a.width<0&&(c=o,o=u,u=c),a.height<0&&(c=s,s=h,h=c),u-o-2*d<0&&(d=(u-o)/2),h-s-2*d<0&&(d=(h-s)/2),n.moveTo(o+d,s),n.lineTo(u-d,s),n.arc(u-d,s+d,d,3*i/2,2*i,!1),n.lineTo(u,h-d),n.arc(u-d,h-d,d,0,i/2,!1),n.lineTo(o+d,h),n.arc(o+d,h-d,d,i/2,i,!1),n.lineTo(o,s+d),n.arc(o+d,s+d,d,i,3*i/2,!1),a.closed=!0):n.rect(o,s,a.width,a.height)),ne(f[r],n,a),A(f[r],n,a)));return f},e.fn.drawArc=function e(t){var r,n,a,o=this;for(r=0;r<o.length;r+=1)(n=T(o[r]))&&(a=new w(t),U(o[r],a,t,e),a.visible&&(W(o[r],n,a,2*a.radius),Y(o[r],n,a),n.beginPath(),he(o[r],n,a,a),ne(o[r],n,a),A(o[r],n,a)));return o},e.fn.drawEllipse=function e(t){var r,n,a,o,i,s=this;for(r=0;r<s.length;r+=1)(n=T(s[r]))&&(a=new w(t),U(s[r],a,t,e),a.visible&&(W(s[r],n,a,a.width,a.height),Y(s[r],n,a),o=a.width*(4/3),i=a.height,n.beginPath(),n.moveTo(a.x,a.y-i/2),n.bezierCurveTo(a.x-o/2,a.y-i/2,a.x-o/2,a.y+i/2,a.x,a.y+i/2),n.bezierCurveTo(a.x+o/2,a.y+i/2,a.x+o/2,a.y-i/2,a.x,a.y-i/2),ne(s[r],n,a),a.closed=!0,A(s[r],n,a)));return s},e.fn.drawPolygon=function e(t){var r,n,a,o,s,l,d,c,f,g,v=this;for(r=0;r<v.length;r+=1)if((n=T(v[r]))&&(a=new w(t),U(v[r],a,t,e),a.visible)){for(W(v[r],n,a,2*a.radius),Y(v[r],n,a),o=(l=(s=2*i/a.sides)/2)+i/2,d=a.radius*h(l),n.beginPath(),g=0;g<a.sides;g+=1)c=a.x+a.radius*h(o),f=a.y+a.radius*u(o),n.lineTo(c,f),a.concavity&&(c=a.x+(d+-d*a.concavity)*h(o+l),f=a.y+(d+-d*a.concavity)*u(o+l),n.lineTo(c,f)),o+=s;ne(v[r],n,a),a.closed=!0,A(v[r],n,a)}return v},e.fn.drawSlice=function e(t){var r,n,a,o,s,l,d=this;for(r=0;r<d.length;r+=1)(n=T(d[r]))&&(a=new w(t),U(d[r],a,t,e),a.visible&&(W(d[r],n,a,2*a.radius),Y(d[r],n,a),a.start*=a._toRad,a.end*=a._toRad,a.start-=i/2,a.end-=i/2,a.start=se(a.start),a.end=se(a.end),a.end<a.start&&(a.end+=2*i),o=(a.start+a.end)/2,s=a.radius*a.spread*h(o),l=a.radius*a.spread*u(o),a.x+=s,a.y+=l,n.beginPath(),n.arc(a.x,a.y,a.radius,a.start,a.end,a.ccw),n.lineTo(a.x,a.y),ne(d[r],n,a),a.closed=!0,A(d[r],n,a)));return d},e.fn.drawLine=function e(t){var r,n,a,o=this;for(r=0;r<o.length;r+=1)(n=T(o[r]))&&(a=new w(t),U(o[r],a,t,e),a.visible&&(W(o[r],n,a),Y(o[r],n,a),n.beginPath(),ge(o[r],n,a,a),ne(o[r],n,a),A(o[r],n,a)));return o},e.fn.drawQuadratic=function e(t){var r,n,a,o=this;for(r=0;r<o.length;r+=1)(n=T(o[r]))&&(a=new w(t),U(o[r],a,t,e),a.visible&&(W(o[r],n,a),Y(o[r],n,a),n.beginPath(),ve(o[r],n,a,a),ne(o[r],n,a),A(o[r],n,a)));return o},e.fn.drawBezier=function e(t){var r,n,a,o=this;for(r=0;r<o.length;r+=1)(n=T(o[r]))&&(a=new w(t),U(o[r],a,t,e),a.visible&&(W(o[r],n,a),Y(o[r],n,a),n.beginPath(),pe(o[r],n,a,a),ne(o[r],n,a),A(o[r],n,a)));return o},e.fn.drawVector=function e(t){var r,n,a,o=this;for(r=0;r<o.length;r+=1)(n=T(o[r]))&&(a=new w(t),U(o[r],a,t,e),a.visible&&(W(o[r],n,a),Y(o[r],n,a),n.beginPath(),we(o[r],n,a,a),ne(o[r],n,a),A(o[r],n,a)));return o},e.fn.drawPath=function e(t){var r,n,a,o,i,s=this;for(r=0;r<s.length;r+=1)if((n=T(s[r]))&&(a=new w(t),U(s[r],a,t,e),a.visible)){for(W(s[r],n,a),Y(s[r],n,a),n.beginPath(),o=1;void 0!==(i=a["p"+o]);)"line"===(i=new w(i)).type?ge(s[r],n,a,i):"quadratic"===i.type?ve(s[r],n,a,i):"bezier"===i.type?pe(s[r],n,a,i):"vector"===i.type?we(s[r],n,a,i):"arc"===i.type&&he(s[r],n,a,i),o+=1;ne(s[r],n,a),A(s[r],n,a)}return s},e.fn.drawText=function e(t){var r,n,a,o,s,l,u,h,d,c,f,g,p,y=this;for(r=0;r<y.length;r+=1)if((n=T(y[r]))&&(a=new w(t),U(y[r],a,t,e),a.visible)){if(n.textBaseline=a.baseline,n.textAlign=a.align,xe(y[r],n,a),o=null!==a.maxWidth?_e(n,a):a.text.toString().split("\n"),be(y[r],n,a,o),W(y[r],n,a,a.width,a.height),Y(y[r],n,a),g=a.x,"left"===a.align?a.respectAlign?a.x+=a.width/2:g-=a.width/2:"right"===a.align&&(a.respectAlign?a.x-=a.width/2:g+=a.width/2),a.radius)for(u=parseFloat(a.fontSize),null===a.letterSpacing&&(a.letterSpacing=u/500),l=0;l<o.length;l+=1){for(n.save(),n.translate(a.x,a.y),s=o[l],a.flipArcText&&((d=s.split("")).reverse(),s=d.join("")),h=s.length,n.rotate(-i*a.letterSpacing*(h-1)/2),f=0;f<h;f+=1)c=s[f],0!==f&&n.rotate(i*a.letterSpacing),n.save(),n.translate(0,-a.radius),a.flipArcText&&n.scale(-1,-1),n.fillText(c,0,0),"transparent"!==a.fillStyle&&(n.shadowColor="transparent"),0!==a.strokeWidth&&n.strokeText(c,0,0),n.restore();a.radius-=u,a.letterSpacing+=u/(1e3*i),n.restore()}else for(l=0;l<o.length;l+=1)s=o[l],p=a.y+l*a.height/o.length-(o.length-1)*a.height/o.length/2,n.shadowColor=a.shadowColor,n.fillText(s,g,p),"transparent"!==a.fillStyle&&(n.shadowColor="transparent"),0!==a.strokeWidth&&n.strokeText(s,g,p);p=0,"top"===a.baseline?p+=a.height/2:"bottom"===a.baseline&&(p-=a.height/2),a._event&&(n.beginPath(),n.rect(a.x-a.width/2,a.y-a.height/2+p,a.width,a.height),ne(y[r],n,a),n.closePath()),j(n,a)}return v.propCache=a,y},e.fn.measureText=function(e){var t,r,n,a=this;return(!(r=a.getLayer(e))||r&&!r._layer)&&(r=new w(e)),(t=T(a[0]))&&(xe(a[0],t,r),n=null!==r.maxWidth?_e(t,r):r.text.split("\n"),be(a[0],t,r,n)),r},e.fn.drawImage=function t(r){var n,a,o,i,s,l,u,h,d,c=this,f=v.imageCache;function g(t,r,n,a,o){return function(){var i=e(t);if(function(e,t,r,n,a){null===n.width&&null===n.sWidth&&(n.width=n.sWidth=u.width),null===n.height&&null===n.sHeight&&(n.height=n.sHeight=u.height),a&&(a.width=n.width,a.height=n.height),null!==n.sWidth&&null!==n.sHeight&&null!==n.sx&&null!==n.sy?(null===n.width&&(n.width=n.sWidth),null===n.height&&(n.height=n.sHeight),n.cropFromCenter&&(n.sx+=n.sWidth/2,n.sy+=n.sHeight/2),n.sy-n.sHeight/2<0&&(n.sy=n.sHeight/2),n.sy+n.sHeight/2>u.height&&(n.sy=u.height-n.sHeight/2),n.sx-n.sWidth/2<0&&(n.sx=n.sWidth/2),n.sx+n.sWidth/2>u.width&&(n.sx=u.width-n.sWidth/2),W(0,t,n,n.width,n.height),Y(e,t,n),t.drawImage(u,n.sx-n.sWidth/2,n.sy-n.sHeight/2,n.sWidth,n.sHeight,n.x-n.width/2,n.y-n.height/2,n.width,n.height)):(W(0,t,n,n.width,n.height),Y(e,t,n),t.drawImage(u,n.x-n.width/2,n.y-n.height/2,n.width,n.height)),t.beginPath(),t.rect(n.x-n.width/2,n.y-n.height/2,n.width,n.height),ne(e,t,n),t.closePath(),j(t,n),D(t,r,n)}(t,r,n,a,o),a.layer?Q(i,n,o,"load"):a.load&&a.load.call(i[0],o),a.layer&&(o._masks=n.transforms.masks.slice(0),a._next)){var s=n.drawLayersComplete;delete n.drawLayersComplete,i.drawLayers({clear:!1,resetFire:!0,index:a._next,complete:s})}}}for(a=0;a<c.length;a+=1)n=c[a],(o=T(c[a]))&&(i=z(c[a]),s=new w(r),l=U(c[a],s,r,t),s.visible&&(h=(d=s.source).getContext,d.src||h?u=d:d&&(f[d]&&f[d].complete?u=f[d]:(u=new Image,d.match(/^data:/i)||(u.crossOrigin=s.crossOrigin),u.src=d,f[d]=u)),u&&(u.complete||h?g(n,o,i,s,l)():u.onload=g(n,o,i,s,l))));return c},e.fn.createPattern=function(t){var r,n,a,o,i,s,l=this;function u(){i=r.createPattern(a,n.repeat),n.load&&n.load.call(l[0],i)}return(r=T(l[0]))?C(s=(n=new w(t)).source)?((a=e("<canvas />")[0]).width=n.width,a.height=n.height,o=T(a),s.call(a,o),u()):(o=s.getContext,s.src||o?a=s:(a=new Image,s.match(/^data:/i)||(a.crossOrigin=n.crossOrigin),a.src=s),a.complete||o?u():a.onload=u):i=null,i},e.fn.createGradient=function(e){var t,r,n,a,o,i,s,l,u,h,d=[];if(r=new w(e),t=T(this[0])){for(r.x1=r.x1||0,r.y1=r.y1||0,r.x2=r.x2||0,r.y2=r.y2||0,n=null!==r.r1&&null!==r.r2?t.createRadialGradient(r.x1,r.y1,r.r1,r.x2,r.y2,r.r2):t.createLinearGradient(r.x1,r.y1,r.x2,r.y2),s=1;void 0!==r["c"+s];s+=1)void 0!==r["s"+s]?d.push(r["s"+s]):d.push(null);for(a=d.length,null===d[0]&&(d[0]=0),null===d[a-1]&&(d[a-1]=1),s=0;s<a;s+=1){if(null!==d[s]){for(u=1,h=0,o=d[s],l=s+1;l<a;l+=1){if(null!==d[l]){i=d[l];break}u+=1}o>i&&(d[l]=d[s])}else null===d[s]&&(h+=1,d[s]=o+h*((i-o)/u));n.addColorStop(d[s],r["c"+(s+1)])}}else n=null;return n},e.fn.setPixels=function e(t){var r,n,a,o,i,s,l,u,h,d,c=this;for(n=0;n<c.length;n+=1)if(a=T(r=c[n]),o=z(c[n]),a&&(U(r,i=new w(t),t,e),W(c[n],a,i,i.width,i.height),null!==i.width&&null!==i.height||(i.width=r.width,i.height=r.height,i.x=i.width/2,i.y=i.height/2),0!==i.width&&0!==i.height)){if(d=(u=(l=a.getImageData((i.x-i.width/2)*o.pixelRatio,(i.y-i.height/2)*o.pixelRatio,i.width*o.pixelRatio,i.height*o.pixelRatio)).data).length,i.each)for(h=0;h<d;h+=4)s={r:u[h],g:u[h+1],b:u[h+2],a:u[h+3]},i.each.call(r,s,i),u[h]=s.r,u[h+1]=s.g,u[h+2]=s.b,u[h+3]=s.a;a.putImageData(l,(i.x-i.width/2)*o.pixelRatio,(i.y-i.height/2)*o.pixelRatio),a.restore()}return c},e.fn.getCanvasImage=function(e,t){var r,n=null;return 0!==this.length&&(r=this[0]).toDataURL&&(void 0===t&&(t=1),n=r.toDataURL("image/"+e,t)),n},e.fn.detectPixelRatio=function(e){var t,r,n,a,o,i,s,l=this;for(r=0;r<l.length;r+=1)n=T(t=l[r]),(s=z(l[r])).scaled||(1!==(a=(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1))&&(o=t.width,i=t.height,t.width=o*a,t.height=i*a,t.style.width=o+"px",t.style.height=i+"px",n.scale(a,a)),s.pixelRatio=a,s.scaled=!0,e&&e.call(t,a));return l},b.clearCache=function(){var e;for(e in v)Object.prototype.hasOwnProperty.call(v,e)&&(v[e]={})},e.support.canvas=void 0!==e("<canvas />")[0].getContext,r(b,{defaults:t,setGlobalProps:Y,transformShape:W,detectEvents:ne,closePath:A,setCanvasFont:xe,measureText:be}),e.jCanvas=b,e.jCanvasObject=w}));
//# sourceMappingURL=jcanvas.min.js.map
